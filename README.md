# Ookii.CommandLine [![NuGet](https://img.shields.io/nuget/v/Ookii.CommandLine)](https://www.nuget.org/packages/Ookii.CommandLine/)

Ookii.CommandLine is a powerful and flexible command line argument parsing library for .Net
applications. It allows you to easily define strongly-typed required, optional, positional and named
arguments, parse the command line arguments, generate usage information, and write applications with
subcommands.

Ookii.CommandLine is provided in versions for [.Net Standard 2.0, .Net Standard 2.1, and .Net 6.0
and later](#requirements).

Ookii.CommandLine can be added to your project using [NuGet](https://nuget.org/packages/Ookii.CommandLine).
[Code snippets](docs/Code%20Snippets.md) for Visual Studio are available on the
[Visual Studio marketplace](https://www.ookii.org/Link/CommandLineSnippets).

## Overview

Ookii.CommandLine is a library that lets you parse the command line arguments for your application
into a set of strongly-typed, named values. You can easily define the accepted arguments, and then
parse the command line supplied to your application for those arguments. In addition, you can
generate usage help that can be displayed to the user.

Ookii.CommandLine can be used with any kind of .Net application, whether console or GUI. Although a
limited subset of functionality—particularly related around generating usage help text—is geared
primarily towards console applications that are invoked from the command line, the main command line
parsing functionality is usable in any application that needs to process command line arguments.

The [command line parsing rules](docs/Arguments.md) are similar to those used by PowerShell. Each
argument has a name (case insensitive by default), and can be supplied by name on the command line.
An argument can also be positional, in which case it can be supplied without the name. Arguments can
be required or optional, and can be switch arguments (which don't need a value but are either
present or not) or accept multiple values. Various aspects of the parsing behavior can be
customized, and there is also support for a mode where arguments have long and short names with
different prefixes.

To define a set of command line arguments, you create a class that will hold their values. The
constructor parameters and properties of that class determine which arguments are accepted.
Attributes can be used to specify things such as the argument name and whether or not an argument is
required or positional, and to specify descriptions used in the generated usage help.

For example, the following class defines four arguments: a required positional argument, an optional
positional argument, a named argument, and a switch argument:

```csharp
class MyArguments
{
    [CommandLineArgument(Position = 0, IsRequired = true)]
    public string? Required { get; set; }
    [CommandLineArgument(Position = 1)]
    public int Optional { get; set; }
    [CommandLineArgument]
    public DateTime Named { get; set; }
    [CommandLineArgument]
    public bool Switch { get; set; }
}
```

To parse these arguments, all you have to do is add the following line to your `Main` method:

```csharp
var arguments = CommandLineParser.Parse<MyArguments>();
```

And that's it! This code will take the arguments from `Environment.GetCommandLineArgs()` (you can
also manually pass an `args` array if you want), will handle and print errors to the console, and
will print usage help if needed. It returns an instance of `MyArguments` if successful, and `null`
if not.

If the arguments are invalid, or help is requested, this application will print the following usage
help:

```text
Usage: MyApplication [-Required] <String> [[-Optional] <Number>] [-Help] [-Named <DateTime>]
   [-Switch] [-Version]
```

The application has two arguments that weren't in the class, `-Help` and `-Version`, which are
automatically added by default. The usage help can be greatly expanded when you add descriptions and
other constraints to your arguments. See the [documentation for the samples](src/Samples) for
several full examples of usage help generated by Ookii.CommandLine.

An example invocation of this application, specifying all the arguments, would look like this:

```text
./MyApplication foo 42 -Switch -Named 2022-08-14
```

In addition, Ookii.CommandLine can be used to create applications that have [multiple subcommands](docs/Subcommands.md),
each with their own arguments.

[Try it yourself on .Net Fiddle](https://dotnetfiddle.net/fgLvSl).

## Requirements

Ookii.CommandLine is a class library for use in your own applications for [Microsoft
.Net](https://dotnet.microsoft.com/). It can be used with applications supporting one of the
following:

- .Net Standard 2.0
- .Net Standard 2.1
- .Net 6.0

As of version 3.0, .Net Framework 2.0 is no longer supported. You can still target .Net Framework
4.6.1 and later using the .Net Standard 2.0 package. If you need to support an older version of
.Net, please continue to use [version 2.4](https://github.com/SvenGroot/ookii.commandline/releases/tag/v2.4).

The .Net Standard 2.1 and .Net 6.0 version utilize `ReadOnlySpan<char>` for improved performance of
the [`LineWrappingTextWriter`](docs/Utilities.md) class.

The .Net 6.0 version has additional support for [nullable reference types](docs/Arguments.md#arguments-with-non-nullable-types).

## Building and testing

To build Ookii.CommandLine, make sure you have the .Net 6.0 SDK installed, and simply use the
`dotnet build` command in the `src` directory. You can run the unit tests using `dotnet test`. The
tests should pass on all platforms (Windows and Linux have been tested).

The tests are built and run for both .Net 6.0 and .Net Framework 4.8. Running the .Net Framework
tests on a non-Windows platform may require the use of [Mono](https://www.mono-project.com/).

Ookii.CommandLine uses a strongly-typed resources file, which will not update correctly unless the
`Resources.resx` file is edited with [Microsoft Visual Studio](https://visualstudio.microsoft.com/).
I could not find a way to make this work correctly with both Visual Studio and the `dotnet` command.

The class library documentation is generated using [Sandcastle Help File Builder](https://github.com/EWSoftware/SHFB).

## More information

Please check out the following to get started:

- [Tutorial: getting started with Ookii.CommandLine](docs/Tutorial.md)
- [Migrating from Ookii.CommandLine 2.x](docs/Migrating.md)
- [Usage documentation](docs/Documentation.md)
- [Class library documentation](https://www.ookii.org/Link/CommandLineDoc)
- [Sample applications](src/Samples) with detailed explanations and sample output.
